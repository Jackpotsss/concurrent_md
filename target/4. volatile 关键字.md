# 4. volatile 关键字

​	volatile 变量是Java语言提供的一种稍弱的同步机制，用来确保将共享变量的更新操作通知到其他线程。

​	volatile 的英文释义是不稳定的、易挥发的，在计算科学中的意思就是**易失性**的，volatile 关键字修饰的变量在线程私有内存中具有易失性。

volatile 关键字的内存语义如下：

- 保证对单个volatile 变量读的可见性，线程总是能读到最新的变量值（即任意线程对该共享变量的最后写入）。
- 保证对单个volatile 变量写的可见性，线程对volatile 变量的写会立即被刷新到主内存中，并且使其他线程所持有该变量的缓存值失效，其他线程必须重新读取最新的volatile 变量值。



当且仅当满足以下条件时，才应该使用volatile 变量：

1. 多写多读，前提是对变量的写入操作不能依赖原值！
2. 一写多读，确保只有单个线程更新变量的值；
3. 访问变量不需要加锁；



注：

- 加锁机制可以保证原子性和可见性，但 volatile 只能保证可见性，不能保证原子性。

- volatile 变量对内存可见性的影响比volatile 变量本身的意义更为重要。




特别注意：

​	volatile 变量在一写多读的场景下，可以保证线程安全；对于多写多读，并且写操作依赖原值，就无法保证线程安全了（比如对volatile 变量进行i++操作）。



